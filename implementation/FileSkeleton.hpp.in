#ifndef ENDFTK_IMPLEMENTATION_FILESKELETON_HPP
#define ENDFTK_IMPLEMENTATION_FILESKELETON_HPP

#include <unordered_map>
#include <functional>

/** @brief Skeleton of a File containing a few pieces to know how to locate
 * it.
 */
template<typename Iterator>
class ENDFtk::implementation::FileSkeleton {
  public:
    using SectionSkeleton_t = SectionSkeleton<Iterator>;

    FileSkeleton(const HeadRecord& head,
                 Iterator begin, Iterator& position, const Iterator& end, 
                 long& LN );

    //! Return the File identifier (MF) of the skeleton
    int MF() const { return MF_; }
    const SectionSkeleton_t& operator[] (int MT);

    Iterator begin() const { return begin_; }
    Iterator end() const { return end_; }

    size_t size() const { return sections_.size(); }

    int MF_;          //!< File identifier
    Iterator begin_;  //!< The beginning of the FileSkeleton

    std::vector<SectionSkeleton_t > sectionsIndexed_;
    std::unordered_map<int, SectionSkeleton_t& > sections_;

    Iterator end_;    //!< The end of the FileSkeleton

    static std::vector<SectionSkeleton_t > 
    createIndexedVector(
      const HeadRecord& head,
      Iterator begin, Iterator& position, const Iterator& end, 
      long& lineNumber );

    static std::unordered_map<int, SectionSkeleton_t& >
    createSectionsMap(std::vector<SectionSkeleton_t>& indexed);

};

#include "ENDFtk/implementation/FileSkeleton/src/FileSkeleton.hpp"
#include "ENDFtk/implementation/FileSkeleton/src/createIndexedVector.hpp"
#include "ENDFtk/implementation/FileSkeleton/src/createSectionsMap.hpp"
#include "ENDFtk/implementation/FileSkeleton/src/operator.hpp"
#endif  // ENDFTK_IMPLEMENTATION_FILESKELETON_HPP

