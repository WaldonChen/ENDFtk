#define CATCH_CONFIG_MAIN

#include "catch.hpp"
#include "ENDFtk.hpp"

using namespace njoy::ENDFtk;

SCENARIO( "Testing Resolved Resonance Ranges" ){
  GIVEN( "SLBW range" ){
    std::string ENDF{
      // " 6.114800+4 1.466500+2          0          0          1          06153 2151    1\n"
      // " 6.114800+4 1.000000+0          0          0          1          06153 2151    2\n"
      // " 1.000000-5 1.000000+0          1          1          0          06153 2151    3\n"
      " 6.000000+0 6.380900-1          0          0          1          06153 2151    4\n"
      " 1.466470+2 0.000000+0          0          0          6          16153 2151    5\n"
      " 1.690000-1 6.000000+0 8.018800-2 5.880000-4 7.960000-2 0.000000+06153 2151    6\n"
      " 0.000000+0 0.000000+0          0          0          0          06153 2  099999\n"
      " 0.000000+0 0.000000+0          0          0          0          06153 0  0    0\n" };
    auto begin = ENDF.begin();
    auto end = ENDF.end();
    long lineNumber = 0;
    int MAT = 6153;
    int MF = 2;
    int MT = 151;

    THEN( "an object can be successfully instantiated" ){
      ResonanceParameters::Resolved::Base base(1E-5, 1.0, 0, 0);
      ResonanceParameters::Range range = 
          ResonanceParameters::Resolved::SLBW(
          std::move(base), begin, end, lineNumber, MAT, MF, MT);
    }
  }
  GIVEN( "MLBW range" ){
    std::string ENDF{
      // " 6.916800+4 1.664920+2          0          0          1          06922 2151    1\n"
      // " 6.916800+4 1.000000+0          0          0          1          06922 2151    2\n"
      // " 1.000000-5 3.200000+0          1          2          1          06922 2151    3\n"
      " 0.000000+0 0.000000+0          0          0          1         506922 2151    4\n"
      "         50          2                                            6922 2151    5\n"
      " 1.000000-5 1.238100+0 4.000000+1 1.188400+0 5.000000+1 1.153200+06922 2151    6\n"
      " 6.000000+1 1.126500+0 7.000000+1 1.105300+0 8.000000+1 1.087800+06922 2151    7\n"
      " 9.000000+1 1.073100+0 1.000000+2 1.060500+0 2.000000+2 9.888000-16922 2151    8\n"
      " 3.000000+2 9.547000-1 4.000000+2 9.334000-1 5.000000+2 9.184000-16922 2151    9\n"
      " 6.000000+2 9.069000-1 7.000000+2 8.978000-1 8.000000+2 8.903000-16922 2151   10\n"
      " 9.000000+2 8.839000-1 1.000000+3 8.783000-1 2.000000+3 8.456000-16922 2151   11\n"
      " 3.000000+3 8.286000-1 4.000000+3 8.170000-1 5.000000+3 8.081000-16922 2151   12\n"
      " 6.000000+3 8.008000-1 7.000000+3 7.946000-1 8.000000+3 7.892000-16922 2151   13\n"
      " 9.000000+3 7.844000-1 1.000000+4 7.800000-1 1.200000+4 7.721000-16922 2151   14\n"
      " 1.400000+4 7.653000-1 1.600000+4 7.592000-1 1.800000+4 7.536000-16922 2151   15\n"
      " 2.000000+4 7.484000-1 2.500000+4 7.369000-1 3.000000+4 7.269000-16922 2151   16\n"
      " 3.500000+4 7.180000-1 4.000000+4 7.098000-1 4.200000+4 7.067000-16922 2151   17\n"
      " 4.400000+4 7.038000-1 4.600000+4 7.009000-1 4.800000+4 6.980000-16922 2151   18\n"
      " 5.000000+4 6.953000-1 5.500000+4 6.888000-1 6.000000+4 6.826000-16922 2151   19\n"
      " 6.500000+4 6.767000-1 7.000000+4 6.712000-1 7.500000+4 6.659000-16922 2151   20\n"
      " 8.000000+4 6.608000-1 8.500000+4 6.560000-1 9.000000+4 6.513000-16922 2151   21\n"
      " 9.500000+4 6.469000-1 2.000000+5 5.803000-1                      6922 2151   22\n"
      " 3.000000+0 0.000000+0          0          0          1          06922 2151   23\n"
      " 1.664920+2 0.000000+0          0          0         24          46922 2151   24\n"
      "-2.974700+0 2.500000+0 7.846160-2 4.616000-4 7.800000-2 0.000000+06922 2151   25\n"
      "-9.747000-1 2.500000+0 7.846160-2 4.616000-4 7.800000-2 0.000000+06922 2151   26\n"
      " 1.025300+0 2.500000+0 7.846160-2 4.616000-4 7.800000-2 0.000000+06922 2151   27\n"
      " 3.025300+0 2.500000+0 7.846160-2 4.616000-4 7.800000-2 0.000000+06922 2151   28\n"
      " 0.000000+0 0.000000+0          0          0          0          06922 2  099999\n"};
    auto begin = ENDF.begin();
    auto end = ENDF.end();
    long lineNumber = 0;
    int MAT = 6922;
    int MF = 2;
    int MT = 151;

    THEN( "an object can be successfully instantiated" ){
      ResonanceParameters::Resolved::Base base(1E-5, 1.0, 0, 0);
      ResonanceParameters::Range range = 
          ResonanceParameters::Resolved::MLBW(
          std::move(base), begin, end, lineNumber, MAT, MF, MT);
    }
  }
  GIVEN( "ReichMoore range" ){
    std::string ENDF{
      // " 1.402800+4 2.773700+1          0          0          1          01425 2151    1\n"
      // " 1.402800+4 1.000000+0          0          0          1          01425 2151    2\n"
      // " 1.000000-5 1.750000+6          1          3          0          11425 2151    3\n"
      " 0.000000+0 4.136400-1          1          0          3          31425 2151    4\n"
      " 2.773700+1 4.136400-1          0          0         96         161425 2151    5\n"
      "-3.622100+6 5.000000-1 3.936200+6 1.453600+2 0.000000+0 0.000000+01425 2151    6\n"
      "-8.737300+5 5.000000-1 1.015100-1 1.025300+0 0.000000+0 0.000000+01425 2151    7\n"
      "-3.652900+5 5.000000-1 3.040600-2 1.000000+0 0.000000+0 0.000000+01425 2151    8\n"
      "-6.315900+4 5.000000-1 4.689400-2 1.000000+0 0.000000+0 0.000000+01425 2151    9\n"
      "-4.880100+4 5.000000-1 9.249600-3 1.000000+0 0.000000+0 0.000000+01425 2151   10\n"
      " 5.567700+4 5.000000-1 6.533100+2 1.580300+0 0.000000+0 0.000000+01425 2151   11\n"
      " 1.816200+5 5.000000-1 3.489400+4 5.600000+0 0.000000+0 0.000000+01425 2151   12\n"
      " 3.013100+5 5.000000-1 2.354800+0 3.600000+0 0.000000+0 0.000000+01425 2151   13\n"
      " 5.902900+5 5.000000-1 5.236600+2 3.600000+0 0.000000+0 0.000000+01425 2151   14\n"
      " 1.085200+6 5.000000-1 7.279400+1 3.600000+0 0.000000+0 0.000000+01425 2151   15\n"
      " 1.162700+6 5.000000-1 3.013600+3 3.800000+0 0.000000+0 0.000000+01425 2151   16\n"
      " 1.201200+6 5.000000-1 4.601200+3 3.600000+0 0.000000+0 0.000000+01425 2151   17\n"
      " 1.256400+6 5.000000-1 1.738300+4 3.600000+0 0.000000+0 0.000000+01425 2151   18\n"
      " 2.248700+6 5.000000-1 4.447600+5 3.600000+0 0.000000+0 0.000000+01425 2151   19\n"
      " 3.007300+6 5.000000-1 2.899600+2 3.600000+0 0.000000+0 0.000000+01425 2151   20\n"
      " 3.067800+6 5.000000-1 4.222900+2 3.600000+0 0.000000+0 0.000000+01425 2151   21\n"
      " 2.773700+1 4.943700-1          1          0        102         171425 2151   22\n"
      " 6.773300+4 1.500000+0 2.658900+0 2.500000+0 0.000000+0 0.000000+01425 2151   23\n"
      " 8.679700+4 1.500000+0 7.261800-1 2.500000+0 0.000000+0 0.000000+01425 2151   24\n"
      " 3.996800+5 1.500000+0 8.136100-1 6.600000-1 0.000000+0 0.000000+01425 2151   25\n"
      " 5.326600+5 1.500000+0 5.328100+2 2.500000+0 0.000000+0 0.000000+01425 2151   26\n"
      " 5.655800+5 1.500000+0 1.095300+4 2.900000+0 0.000000+0 0.000000+01425 2151   27\n"
      " 5.871700+5 5.000000-1 1.991600+2 8.800000+0 0.000000+0 0.000000+01425 2151   28\n"
      " 7.140400+5 1.500000+0 1.216500+0 2.500000+0 0.000000+0 0.000000+01425 2151   29\n"
      " 8.124900+5 1.500000+0 3.010000+4 9.700000+0 0.000000+0 0.000000+01425 2151   30\n"
      " 9.100400+5 1.500000+0 3.673300+3 1.130000+0 0.000000+0 0.000000+01425 2151   31\n"
      " 9.622300+5 5.000000-1 7.661400+4 1.600000+1 0.000000+0 0.000000+01425 2151   32\n"
      " 1.199500+6 5.000000-1 1.491400+4 7.600000+0 0.000000+0 0.000000+01425 2151   33\n"
      " 1.408300+6 1.500000+0 5.198300+3 2.700000+0 0.000000+0 0.000000+01425 2151   34\n"
      " 1.482400+6 5.000000-1 8.869400-1 8.800000+0 0.000000+0 0.000000+01425 2151   35\n"
      " 1.592800+6 5.000000-1 1.119900+4 8.800000+0 0.000000+0 0.000000+01425 2151   36\n"
      " 1.658600+6 5.000000-1 1.555300+3 8.800000+0 0.000000+0 0.000000+01425 2151   37\n"
      " 1.805700+6 1.500000+0 1.299100+3 2.500000+0 0.000000+0 0.000000+01425 2151   38\n"
      " 1.852400+6 1.500000+0 7.070700+4 2.500000+0 0.000000+0 0.000000+01425 2151   39\n"
      " 2.773700+1 4.136400-1          2          0        150         251425 2151   40\n"
      " 3.174000+4 2.500000+0 1.566700-2 1.000000+0 0.000000+0 0.000000+01425 2151   41\n"
      " 7.080000+4 2.500000+0 2.961700-2 1.000000+0 0.000000+0 0.000000+01425 2151   42\n"
      " 2.987000+5 2.500000+0 9.886000+0 1.000000+0 0.000000+0 0.000000+01425 2151   43\n"
      " 3.545900+5 2.500000+0 1.446000+1 1.000000+0 0.000000+0 0.000000+01425 2151   44\n"
      " 6.024700+5 1.500000+0 5.049100+1 3.400000+0 0.000000+0 0.000000+01425 2151   45\n"
      " 7.717100+5 2.500000+0 5.313900+1 1.000000+0 0.000000+0 0.000000+01425 2151   46\n"
      " 8.452300+5 1.500000+0 3.979100+2 2.000000+0 0.000000+0 0.000000+01425 2151   47\n"
      " 8.723100+5 2.500000+0 3.214000+1 1.300000+0 0.000000+0 0.000000+01425 2151   48\n"
      " 1.017800+6 2.500000+0 7.619200+1 1.000000+0 0.000000+0 0.000000+01425 2151   49\n"
      " 1.042900+6 2.500000+0 9.337000+2 1.000000+0 0.000000+0 0.000000+01425 2151   50\n"
      " 1.148100+6 2.500000+0 3.146900+0 1.000000+0 0.000000+0 0.000000+01425 2151   51\n"
      " 1.264400+6 2.500000+0 8.436400+2 1.000000+0 0.000000+0 0.000000+01425 2151   52\n"
      " 1.379900+6 1.500000+0 6.529900+1 2.400000+0 0.000000+0 0.000000+01425 2151   53\n"
      " 1.479900+6 1.500000+0 3.502500+3 1.650000+0 0.000000+0 0.000000+01425 2151   54\n"
      " 1.512300+6 2.500000+0 9.149300+1 1.000000+0 0.000000+0 0.000000+01425 2151   55\n"
      " 1.528700+6 1.500000+0 2.922500+3 2.400000+0 0.000000+0 0.000000+01425 2151   56\n"
      " 1.580600+6 1.500000+0 1.495500+3 2.400000+0 0.000000+0 0.000000+01425 2151   57\n"
      " 1.597200+6 1.500000+0 4.017200+3 2.400000+0 0.000000+0 0.000000+01425 2151   58\n"
      " 1.639600+6 2.500000+0 1.529300+4 1.000000+0 0.000000+0 0.000000+01425 2151   59\n"
      " 1.651100+6 2.500000+0 2.155500+4 1.000000+0 0.000000+0 0.000000+01425 2151   60\n"
      " 1.665000+6 1.500000+0 2.159000+2 2.400000+0 0.000000+0 0.000000+01425 2151   61\n"
      " 1.785000+6 1.500000+0 1.929400+2 2.400000+0 0.000000+0 0.000000+01425 2151   62\n"
      " 1.850700+6 2.500000+0 3.551500+4 1.000000+0 0.000000+0 0.000000+01425 2151   63\n"
      " 1.923700+6 2.500000+0 1.017100+3 1.000000+0 0.000000+0 0.000000+01425 2151   64\n"
      " 1.968900+6 2.500000+0 5.734100+3 1.000000+0 0.000000+0 0.000000+01425 2151   65\n"
      " 0.000000+0 0.000000+0          0          0          0          01425 2  099999\n"};
    auto begin = ENDF.begin();
    auto end = ENDF.end();
    long lineNumber = 0;
    int MAT = 1425;
    int MF = 2;
    int MT = 151;

    THEN( "an object can be successfully instantiated" ){
      ResonanceParameters::Resolved::Base base(1E-5, 1.0, 0, 0);
      ResonanceParameters::Range range = 
          ResonanceParameters::Resolved::ReichMoore(
          std::move(base), begin, end, lineNumber, MAT, MF, MT);
    }
  }
}
